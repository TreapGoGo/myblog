---
title: 高级数据结构 学习笔记
date: 2023-07-26 22:11:55
tags:
---

# 前言

本文主要根据 OIwiki 的数据结构部分展开，也按照常见的考点加入了一些图论、字符串领域的数据结构。本文只包含最基本的理论介绍，相关的实现方式、具体的解题思路和代码都放在站内其他文章中。

后续做到比较好的数据结构题也会添加进这篇文章中来。

# 块状数据结构

## 分块初步

经典例题1：参见站内文章 {% post_link 'LOJ6280-分块入门-区间和-解题笔记' %}

总体思路：寻找一种合理的分块方式，操作区间中不是整块的部分暴力求解，是整块的部分打标记。

寻找最优分块方式，通常是对最坏时间复杂度求最小值，取得最小值时的约束条件可以得到最优块长。

在分块的基础上，依然可以使用差分、前缀和等方式来优化算法。差分、前缀和不仅可以对原序列使用，也可以对块序列使用。

相关注意事项：

* 块长不一定等于块数。
* 区间两端点在同一个块中，必须特判后直接 `return` ，否则让程序自然执行可能会把区间外面的部分也算到。

练习题：

* {% post_link 'UVA-12003-Array-Transformer-解题笔记'%} : 分块 + 排序
* {% post_link 'UVA-11990-Dynamic-Inversion-解题笔记'%} ：分块 + 排序 + 树状数组

## 莫队算法初步

### 使用条件

对于序列上的区间询问问题，如果从 $[l,r]$ 的答案能够 $O(1)$ 扩展到与其相邻的区间的答案，那么可以在 $O(n\sqrt{n})$ 的复杂度内求出所有询问的答案。

### 使用方法

1. 对所有询问离线；
2. 将序列进行根号分块；
3. 将所有询问排序，排序规则为：以 $l$ **所在的块的编号**为第一关键字，以 $r$ 的大小为第二关键字，生序排序；
4. 将排序好的询问遍历，每次迭代暴力移动指针更新答案。

### 复杂度计算

OIwiki上面说的太复杂的，我用自己的方法证明一下。

先考虑左端点。

考虑最坏情况，如果每相邻的两次询问，左端点之间的距离都非常远，那最多也只不过是 $O(\sqrt n)$ 级别的距离，因为新旧两个左端点毕竟都在同一个块内。

当迭代进入一个新的块时，左端点也移动的距离最坏也只是 $O(2\sqrt n)$ ，依然没有改变复杂度。

又由于每移动一格更新答案只需要花费 $O(1)$ 的时间，所以对于总共 $n$ 次询问，更新答案的次数只是 $O(n\sqrt n)$ 级别。

再考虑右端点。

因为询问排序时所参考的第二关键字是 $r$ 的大小，所以在同一个块内，所有询问的 $r$ 保持单调不减，右端点一直在向右移动，因此右端点移动的次数最坏为 $O(n)$ 。又由于有 $O(\sqrt n)$ 个块，因此总的复杂度是 $O(n\sqrt n)$ 。

当迭代进入一个新的块时，最坏情况下右端点需要从序列的最右端移回到左端，复杂度依然是 $O(n)$ 。这样的远距离移动最多只需要做 $O(\sqrt n)$ 次，也就是块数次。总的复杂度依然是 $O(n\sqrt n)$ 。

在这个算法中，左右端点的运动相对独立，一个端点的移动不会影响另一个端点的移动次数，两者的复杂度是线性加和而不是相乘，因此总的复杂度为 $O(n\sqrt n)$ 。

### 优化：奇偶化排序

对于奇数块，按 $r$ 升序排序；对于偶数块，按 $r$ 降序排序。

这样的话，左端点进入新块后，右端点可以在回来的路上就把这个块的答案更新好，不用多跑一趟。

这个操作可以实现常数级别的优化。

### 练习题

* {% post_link 'P1494-国家集训队-小Z的袜子-解题笔记'%} ：莫队 + gcd

## 块状数组

所谓块状数组，就是分块版本的线段树。借用线段树中打标记的思想，优先对整块打标记。如果涉及非整块的零碎操作，就把标记暴力下传后暴力修改。

应用场景：遇到**树形数据结构难以维护**的区间操作时，应当考虑块状数组。

## 块状链表

所谓块状链表，其实就是利用链表将原序列分块后以块为节点建立链表，每个节点的大小保持在 $O(\sqrt n)$ 。

随着每一块的大小逐渐增大，将其中的某些节点分裂成新的节点，从而保持每一块的大小都在 $\sqrt n$ 级别。每次分裂可以暴力分裂，一次分裂的时间复杂度为 $O(\sqrt n)$ 。

块状链表实际上是对普通链表的均摊。

|          | 插入、删除、修改 | 单点查询、区间查询 |
| :------: | :--------------: | :----------------: |
| 普通链表 |      $O(1)$      |       $O(n)$       |
| 块状链表 |   $O(\sqrt n)$   |    $O(\sqrt n)$    |

应用场景：当**涉及大量的插入、删除操作**时，应当考虑块状链表。

# 树链剖分

# 二叉搜索树

# 可持久化数据结构

# 树套树

# 动态树

# 图论数据结构

# 字符串数据结构

# 其他高级数据结构
